@page "/forms/wizard"
@using BlazorNifty.Components.MyWizards
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedSessionStorage BrowserStorage 

<PageTitle>Wizard</PageTitle>

<PageShell Rounded="true" Overlapping="true">
    <ShellHeader>
        <MudBreadcrumbs Items="_items" Separator=">"></MudBreadcrumbs>
        <MudText Typo="Typo.h2" Class="page-title" GutterBottom="true">Wizard</MudText>
        <MudText Typo="Typo.body1" Class="mb-2 page-description">A user interface design pattern that enables untrained users to achieve a goal through a series of steps.</MudText>
    </ShellHeader>

    <ShellBody>
        <MudGrid Spacing="2" Style="height: 440px">
            <MudItem xs="4" sm="4" md="4">
                <MudCard Elevation="4">
                    <MudCardContent Style="background-color: rgb(3,169,244); border-radius: 4px">
                        <MudStack Row="false" AlignItems="AlignItems.Center" Justify="Justify.Center" Class="pt-12 pb-12 mt-12 mb-12">
                            <MudText Typo="Typo.h3"><b>Register Today</b></MudText>
                            <MudText Typo="Typo.body2" Style="color: white">Members get 50% more points, so register today and start earning points for savings on great rewards!</MudText>
                            <MudButton Variant="Variant.Filled" Style="color: white">Learn More...</MudButton>
                        </MudStack>                        
                    </MudCardContent>
                </MudCard>
            </MudItem>

            <MudItem xs="8" sm="8" md="8">
                <MudCard Elevation="4">
                    <MudCardContent>
                        <MudStack>
                            <MyWizard OnSubmit="Submit">
                                <MyWizardHeader>
                                </MyWizardHeader>
                                <MyWizardSteps>
                                    <MyWizardStep Title="Account" StepEditContext="firstStepEditContext">
                                        <EditForm EditContext="firstStepEditContext">
                                            <DataAnnotationsValidator />

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">Username</MudText>
                                                <MudTextField T="string" @bind-Value="firstStepWizardModel.UserName" For="@(() => firstStepWizardModel.UserName)" 
                                                    Variant="Variant.Outlined" aria-label="name"></MudTextField>
                                            </MudStack>

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">Email</MudText>
                                                <MudTextField T="string" @bind-Value="firstStepWizardModel.Email" For="@(() => firstStepWizardModel.Email)" Immediate="true"
                                                    Variant="Variant.Outlined" aria-label="email"></MudTextField>
                                            </MudStack>

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">Password</MudText>
                                                <MudTextField T="string" @bind-Value="firstStepWizardModel.Password" For="@(() => firstStepWizardModel.Password)" 
                                                    Variant="Variant.Outlined" aria-label="password"></MudTextField>

                                                <MudText Typo="Typo.body2">Retry password</MudText>
                                                <MudTextField T="string" @bind-Value="firstStepWizardModel.RetypePassword" For="@(() => firstStepWizardModel.RetypePassword)" 
                                                    Variant="Variant.Outlined" aria-label="password"></MudTextField>
                                            </MudStack>
                                        </EditForm>
                                    </MyWizardStep>                                 
                                    <MyWizardStep Title="Profile" StepEditContext="secondStepEditContext" ValidateStep="false">
                                        <EditForm EditContext="secondStepEditContext">
                                            <DataAnnotationsValidator />

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">First name</MudText>
                                                <MudTextField T="string" @bind-Value="secondStepWizardModel.FirstName" For="@(() => secondStepWizardModel.FirstName)" 
                                                    Variant="Variant.Outlined" aria-label="name"></MudTextField>

                                                <MudText Typo="Typo.body2">Last name</MudText>
                                                <MudTextField T="string" @bind-Value="secondStepWizardModel.LastName" For="@(() => secondStepWizardModel.LastName)" Immediate="true"
                                                    Variant="Variant.Outlined" aria-label="name"></MudTextField>
                                            </MudStack>

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">Company</MudText>
                                                <MudTextField T="string" @bind-Value="secondStepWizardModel.Company" Variant="Variant.Outlined"></MudTextField>
                                            </MudStack>

                                            <MudStack Row="true" AlignItems="AlignItems.Center">
                                                <MudText Typo="Typo.body2">Member type</MudText>
                                                <MudRadioGroup T="string">
                                                    <MudRadio T="string">Free</MudRadio>
                                                    <MudRadio T="string">Personal</MudRadio>
                                                    <MudRadio T="string">Bussiness</MudRadio>
                                                </MudRadioGroup> 
                                            </MudStack>
                                        </EditForm>
                                    </MyWizardStep>
                                    <MyWizardStep Title="Finish">
                                        <EditForm EditContext="finishStepEditContext">
                                            <MudText Typo="Typo.h3">Thank you</MudText>
                                            <MudText Typo="Typo.body1">Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</MudText>
                                        </EditForm>
                                    </MyWizardStep>
                                </MyWizardSteps>
                            </MyWizard>
                        </MudStack>                        
                    </MudCardContent>
                </MudCard>
            </MudItem>
        </MudGrid>

        <MudGrid>

        </MudGrid>
    </ShellBody>

</PageShell>

@code {
    private List<BreadcrumbItem> _items = new List<BreadcrumbItem>
    {
        new BreadcrumbItem("Home", href: "#"),
        new BreadcrumbItem("Forms", href: "#"),
        new BreadcrumbItem("Wizard", href: null, disabled: true)
    };

    private EditContext? firstStepEditContext;
    private EditContext? secondStepEditContext;
    private EditContext? addressStepEditContext;
    private EditContext? finishStepEditContext;

    private FirstStepWizardModel firstStepWizardModel = new FirstStepWizardModel();
    private SecondStepWizardModel secondStepWizardModel = new SecondStepWizardModel();

    protected override void OnInitialized()
    {
        firstStepEditContext = new(firstStepWizardModel);
        secondStepEditContext = new(secondStepWizardModel);

        var finishStepWizardModel = new { firstStepWizardModel, secondStepWizardModel };
        finishStepEditContext = new(finishStepWizardModel);
    }

    private void Submit()
    {
        firstStepWizardModel.Email = "test.test@test.cz";
    }
}

